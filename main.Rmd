---
title: "现代统计软件论文"
author:
  - 吴宇翀
  - 高思琴
  - 陈蔚
documentclass: ctexart
output:
  rticles::ctex:
    fig_caption: yes
    number_sections: yes
    toc: yes
classoption: "hyperref,"
---

```{r}
library(caret)
library(kernlab)
```

# 摘要

识别与预测信用卡是否将会逾期（信用卡风控部门）

> 待完善

# 背景

识别与预测信用卡是否将会逾期（信用卡风控部门）

> 待完善

# 数据集说明

```{r}
dat = read.csv("data.csv")
dat = dat[,-1]
dat$SeriousDlqin2yrs = as.factor(dat$SeriousDlqin2yrs)
```

SeriousDlqin2yrs: 是否逾期。
RevolvingUtilizationOfUnsecuredLines：信用卡和个人信贷额度的总余额（百分比）*怀疑此翻译有误*
age：年龄
NumberOfTime30-59DaysPastDueNotWorse：过去2年，借款人逾期30-59天的次数
DebtRatio：负债比率（百分比）
MonthlyIncome：月收入
NumberOfOpenCreditLinesAndLoans：未偿还贷款数量（汽车贷款或抵押贷款等分期付款）和信贷额度（如信用卡）。
NumberOfTimes90DaysLate：借款人逾期90天或以上的次数。
NumberRealEstateLoansOrLines：抵押贷款和房地产贷款的数量。
NumberOfTime60-89DaysPastDueNotWorse：过去2年，借款人逾期60-89天的次数
NumberOfDependents：家庭中的家属人数（配偶，子女等）

> 数据集表格 dictionary


到英文网站上翻译 ^[数据来源: https://www.kaggle.com/c/GiveMeSomeCredit/overview]

> 待完善

## 异常值处理

1. 由于样本量已经足够大，我们删除所有包含缺失值的观测。
2. 由于**信用卡和个人信贷额度的总余额**和**负债比率**两个指标为百分比，我们将这两个指标中小于0的数据调整为0，将大于1的数据调整为1。

```{r}
dat$RevolvingUtilizationOfUnsecuredLines[which(dat$RevolvingUtilizationOfUnsecuredLines < 0)] = 0
dat$RevolvingUtilizationOfUnsecuredLines[which(dat$RevolvingUtilizationOfUnsecuredLines > 1)] = 1
dat$DebtRatio[which(dat$DebtRatio < 0)] = 0
dat$DebtRatio[which(dat$DebtRatio > 1)] = 1
dat_complete = dat[complete.cases(dat),]
```

## 基准正确率

```{r}
summary(dat_complete$SeriousDlqin2yrs)
1 - 8357 / 139974
```

# 部分样本训练

## 抽样

由于数据集样本量过大，难以完成较为复杂的模型求解。 ^[由于条件所限，本研究小组只有单台计算机的算力。在有分布式计算的环境下，可能不需要此步操作。]


```{r}
set.seed(1)
inTraining <- createDataPartition(dat_complete$SeriousDlqin2yrs, p = .01, list = FALSE)
training <- dat_complete[inTraining,]
```


## GBM

```{r include=FALSE}
set.seed(1)
fitControl <- trainControl(## 10-fold CV
                           method = "repeatedcv",
                           number = 10,
                           ## repeated ten times
                           repeats = 5)

set.seed(1)
gbm <- train(SeriousDlqin2yrs ~ ., data = training, 
                 method = "gbm", 
                 trControl = fitControl)
```

## SVM

```{r}
set.seed(1)
fitControl <- trainControl(## 10-fold CV
                           method = "repeatedcv",
                           number = 10,
                           ## repeated ten times
                           repeats = 5)

set.seed(1)
svm <- train(SeriousDlqin2yrs ~ ., data = training, 
                 method = "svmRadial", 
                 trControl = fitControl)
svm
svm$results

trellis.par.set(caretTheme())
plot(svm)

trellis.par.set(caretTheme())
plot(svm, metric = "Kappa")

trellis.par.set(caretTheme())
densityplot(svm, pch = "|")
```

## Logit

```{r}
set.seed(1)
fitControl <- trainControl(## 10-fold CV
                           method = "repeatedcv",
                           number = 10,
                           ## repeated ten times
                           repeats = 5)

set.seed(1)
logit <- train(SeriousDlqin2yrs ~ ., data = training, 
                 method = "glm", 
                 trControl = fitControl)
logit
logit$results

trellis.par.set(caretTheme())
plot(logit)

trellis.par.set(caretTheme())
plot(logit, metric = "Kappa")

trellis.par.set(caretTheme())
densityplot(logit, pch = "|")
```

## 模型间的比较

我们对 ... 和 ... 模型进行比较，两个模型都使用相同的重抽样方法估计各自的模型表现。 ^[由于设置的随机数种子相同，故不同模型使用的重抽样样本完全一致。]

```{r}
resamp = resamples(list(GBM = gbm, SVM = svm, Logit = logit))
summary(resamp)
summary(diff(resamp))
ggplot(resamp,
       models = c("GBM", "SVM", "Logit"),
       metric = "Accuracy",
       conf.level = 0.95) +
  theme_bw()
```

分析图，在 95% 的置信区间下，.....

分析p值

.....结果表明，X个模型表现十分接近。

# 全部样本 logit regression

```{r}
logit = glm(SeriousDlqin2yrs ~ ., data = dat_complete, family = binomial)
summary(logit)
```

分析逻辑回归的方向、变量显著性。

# 附录

## 数据

```{r}
str(dat)
```
